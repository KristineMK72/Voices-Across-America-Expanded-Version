<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ðŸ’¬ Voices Across America â€” Unity Edition</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  html, body {
    height: 100%;
    margin: 0;
    background: #000;
    color: #fff;
    font-family: "Segoe UI", sans-serif;
    overflow: hidden;
  }

  #map {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    z-index: 1;
    background: #000;
  }

  header {
    position: fixed;
    top: 0;
    width: 100%;
    text-align: center;
    padding: 1rem;
    background: rgba(0, 0, 0, 0.7);
    z-index: 1000;
  }

  header h1 {
    margin: 0;
    font-size: 1.8rem;
    color: #fff;
  }

  header p {
    margin: 0.4rem 0 0;
    font-size: 1rem;
    color: #ccc;
  }

  /* Narration banner that moves across bottom */
  #narration {
    position: fixed;
    bottom: 4%;
    width: 100%;
    text-align: center;
    font-size: 1.3rem;
    color: #ffe8b5;
    font-style: italic;
    white-space: nowrap;
    overflow: hidden;
    opacity: 0.9;
    z-index: 1001;
    animation: moveText 14s linear infinite;
  }

  @keyframes moveText {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }

  /* Ripple + twinkle */
  @keyframes ripple {
    0% { transform: scale(0.3); opacity: 0.8; }
    80% { transform: scale(4); opacity: 0.1; }
    100% { transform: scale(4.5); opacity: 0; }
  }

  @keyframes twinkle {
    0%, 100% { opacity: 0.6; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.3); }
  }

  .ripple {
    position: absolute;
    width: 20px;
    height: 20px;
    background: radial-gradient(circle, rgba(255,223,150,0.8) 0%, rgba(255,223,150,0.1) 70%, transparent 100%);
    border-radius: 50%;
    pointer-events: none;
    animation: ripple 4s ease-out;
  }

  .city-dot {
    width: 12px;
    height: 12px;
    background: radial-gradient(circle, #aee8ff 0%, #88e0ff 50%, rgba(255,255,255,0) 80%);
    border-radius: 50%;
    box-shadow: 0 0 15px rgba(180,220,255,0.9);
    opacity: 0.9;
    animation: twinkle 4s ease-in-out infinite;
    cursor: pointer;
  }

  #toggleAnimation {
    position: fixed;
    bottom: 10%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.3);
    color: #fff;
    font-size: 1rem;
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    z-index: 1002;
    cursor: pointer;
    backdrop-filter: blur(5px);
    transition: background 0.3s;
  }

  #toggleAnimation:hover {
    background: rgba(255,255,255,0.2);
  }

  .leaflet-popup-content-wrapper {
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-size: 0.95rem;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.2);
  }
</style>
</head>

<body>
  <header>
    <h1>ðŸ’¬ Voices Across America</h1>
    <p>Every light is a voice. Every voice brings hope.</p>
  </header>

  <div id="map"></div>
  <div id="narration">A spark of hope ignites...</div>
  <button id="toggleAnimation">Pause</button>

  <script>
    const map = L.map('map', {
      center: [39.5, -98.35],
      zoom: 4,
      zoomControl: false,
      attributionControl: false
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    const cities = [
      { name: "Los Angeles", coords: [34.0522, -118.2437], message: "A voice for change echoes in the West." },
      { name: "San Francisco", coords: [37.7749, -122.4194], message: "Innovation meets compassion." },
      { name: "Seattle", coords: [47.6062, -122.3321], message: "Empathy grows like rain." },
      { name: "Denver", coords: [39.7392, -104.9903], message: "Hope rises over the Rockies." },
      { name: "Dallas", coords: [32.7767, -96.7970], message: "Every voice matters â€” every heart counts." },
      { name: "Minneapolis", coords: [44.9778, -93.2650], message: "From still waters, action flows." },
      { name: "Chicago", coords: [41.8781, -87.6298], message: "The heartland beats with courage." },
      { name: "Atlanta", coords: [33.7490, -84.3880], message: "The spirit of unity endures." },
      { name: "Miami", coords: [25.7617, -80.1918], message: "Waves carry stories of resilience." },
      { name: "New York City", coords: [40.7128, -74.0060], message: "Where millions of voices become one." },
      { name: "Boston", coords: [42.3601, -71.0589], message: "Ideas spark, and hearts open." },
      { name: "Washington, D.C.", coords: [38.9072, -77.0369], message: "A light for justice flickers brighter." },
      { name: "Phoenix", coords: [33.4484, -112.0740], message: "The desert blooms with empathy." },
      { name: "Portland", coords: [45.5152, -122.6784], message: "Kindness flows with the river." }
    ];

    const dotLayer = L.layerGroup().addTo(map);

    cities.forEach(city => {
      const divIcon = L.divIcon({
        className: 'city-dot',
        iconSize: [12, 12]
      });

      const marker = L.marker(city.coords, { icon: divIcon }).addTo(dotLayer);
      marker.bindPopup(`<strong>${city.name}</strong><br>${city.message}`);
      marker.on('click', () => rippleAt(city));
    });

    function rippleAt(city) {
      const point = map.latLngToContainerPoint(city.coords);
      const ripple = document.createElement('div');
      ripple.className = 'ripple';
      ripple.style.left = (point.x - 10) + 'px';
      ripple.style.top = (point.y - 10) + 'px';
      document.getElementById('map').appendChild(ripple);
      setTimeout(() => ripple.remove(), 4000);
    }

    // Ripple animation
    let isAnimating = true;
    function animateRipples() {
      if (!isAnimating) return;
      const city = cities[Math.floor(Math.random() * cities.length)];
      rippleAt(city);
      setTimeout(animateRipples, 1200 + Math.random() * 2000);
    }
    animateRipples();

    // Narration cycling across bottom
    const lines = [
      "A spark of hope ignites...",
      "Empathy ripples across cities...",
      "From Minneapolisâ€™s music to NYCâ€™s hustle...",
      "Every voice builds a brighter future.",
      "Together, we rise in unity."
    ];
    let i = 0;
    function cycleNarration() {
      if (!isAnimating) return;
      const el = document.getElementById('narration');
      el.textContent = lines[i];
      i = (i + 1) % lines.length;
    }
    setInterval(cycleNarration, 7000);

    // Toggle play/pause
    const toggleButton = document.getElementById('toggleAnimation');
    toggleButton.addEventListener('click', () => {
      isAnimating = !isAnimating;
      toggleButton.textContent = isAnimating ? 'Pause' : 'Play';
      if (isAnimating) {
        animateRipples();
        cycleNarration();
      }
    });
  </script>
</body>
</html>
